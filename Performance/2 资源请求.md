## 资源请求

### 思路
影响资源请求耗时的因素有哪些？

1. 请求并发数量（http版本，使用多个域名）
2. 资源请求的顺序（这里主要考虑尽早加载关键资源，延迟加载非关键资源）
3. 单个请求的时间（减少资源体积 / tree shaking / 压缩 / 缓存）

### 一 并发数量

#### 1. 升级http2
- HTTP/1.1 需要优化资源加载，例如合并文件、使用内容分发网络（CDN），以减少请求次数和提升加载速度。

- HTTP/2
1. 多路复用：在单一连接上同时处理多个请求和响应，消除了请求阻塞问题。
2. 头部压缩：采用 HPACK 算法压缩头部信息，减少了带宽消耗。
3. 服务器推送：服务器可以主动发送资源到客户端缓存中，降低延迟。

- HTTP/3

1. 基于 UDP：利用 UDP 实现更快速的连接建立和传输，减少了握手延迟。
2. 内置加密：集成了 TLS 1.3 加密，提升了安全性和性能。
3. 更强的抗丢包能力：QUIC 通过独立流的设计，即使在丢包情况下也不会影响其他流的传输，提高了稳定性。

#### 2. 使用多个域名（域名分片）
1. 使用多个子域名
2. 使用不同的顶级域名
3. CDN

### 二 资源请求的顺序
#### 1. 关键资源尽早获取
- dns-prefetch, dns预获取。
- preconnect, 域名预连接，如果资源需要https连接，可添加crossorigin属性
    ```
    <link rel="preconnect" href="XXX" crossorigin>
    ```

- preload 提升资源加载的优先级
- prefetch 预加载资源

    谨慎选择，过度使用会导致不必要的带宽消耗。

#### 2. 非关键资源延迟加载/执行
- async     
- defer（按照顺序执行）
- 按需加载

### 三 单个请求的时间

#### 1. 减少体积，代码分割
#### 2. tree shaking
#### 3. 压缩
#### 4. 缓存相关
之前看到我们官网强缓存5分钟，感觉可以久一点，大部分是静态图片